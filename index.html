<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Console</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; }
        #top-bar { height: 50px; background: #1a1a1a; display: flex; align-items: center; padding: 0 15px; border-bottom: 1px solid #333; }
        #url-input { flex: 1; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #222; color: #fff; margin-right: 10px; }
        button { padding: 8px 15px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        #content-frame { width: 100%; height: calc(100% - 50px); border: none; background: white; }
    </style>
</head>
<body>
    <div id="top-bar">
        <input type="text" id="url-input" value="https://openfront.io/">
        <button onclick="browse()">Launch</button>
    </div>
    <div id="display-area" style="height: calc(100% - 50px); width: 100%; overflow: auto; background: white;">
        </div>

    <script>
        async function browse() {
            const target = document.getElementById('url-input').value;
            const display = document.getElementById('display-area');
            
            // Using a public CORS bridge to fetch the raw data
            const bridge = "https://api.allorigins.win/raw?url=";
            
            try {
                const response = await fetch(bridge + encodeURIComponent(target));
                let html = await response.text();
                
                // PRE-FIX: This injects a base tag so Openfront's scripts load from its real server
                // This prevents the "404" errors for JS and CSS files
                const baseTag = `<base href="${target}">`;
                
                if (html.includes('<head>')) {
                    html = html.replace('<head>', '<head>' + baseTag);
                } else {
                    html = baseTag + html;
                }

                // Inject the HTML into our display area
                display.innerHTML = html;

                // Re-execute scripts (since innerHTML doesn't run <script> tags)
                Array.from(display.querySelectorAll("script")).forEach( oldScript => {
                    const newScript = document.createElement("script");
                    Array.from(oldScript.attributes).forEach( attr => newScript.setAttribute(attr.name, attr.value) );
                    newScript.appendChild(document.createTextNode(oldScript.innerHTML));
                    oldScript.parentNode.replaceChild(newScript, oldScript);
                });
            } catch (err) {
                display.innerHTML = "<p style='color:red; padding: 20px;'>Error: " + err.message + "</p>";
            }
        }
    </script>
</body>
</html>
