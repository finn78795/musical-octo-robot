<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workstation Console</title>
    <style>
        body { margin: 0; padding: 0; height: 100vh; display: flex; flex-direction: column; background: #000; font-family: system-ui, -apple-system, sans-serif; }
        #bar { background: #1a1a1a; padding: 8px; display: flex; gap: 8px; border-bottom: 1px solid #333; z-index: 9999; }
        input { flex: 1; padding: 10px; border-radius: 6px; border: 1px solid #444; background: #2a2a2a; color: #fff; outline: none; }
        button { padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; }
        button:hover { background: #2563eb; }
        #frame-container { flex: 1; position: relative; background: #fff; }
        iframe { width: 100%; height: 100%; border: none; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="bar">
        <button onclick="goBack()">â¬…</button>
        <input type="text" id="urlInput" placeholder="Enter URL (e.g. wikipedia.org)" onkeydown="if(event.key==='Enter') load()">
        <button onclick="load()">Browse</button>
    </div>
    <div id="frame-container">
        <iframe id="viewer" name="viewer"></iframe>
    </div>

    <script>
        // THE ENGINE: Uses Google's Gadget Proxy to bypass CORS and Header blocks
        const proxyBase = "https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&refresh=604800&url=";

        function load() {
            let url = document.getElementById('urlInput').value;
            if (!url) return;
            if (!url.startsWith('http')) url = 'https://' + url;

            // Encapsulating the URL to prevent the browser from "escaping" the proxy
            const finalUrl = proxyBase + encodeURIComponent(url);
            document.getElementById('viewer').src = finalUrl;
        }

        function goBack() {
            window.frames['viewer'].history.back();
        }

        // Feature: Auto-fix links inside the proxy every 2 seconds
        setInterval(() => {
            const frame = document.getElementById('viewer');
            try {
                const frameDoc = frame.contentDocument || frame.contentWindow.document;
                const links = frameDoc.getElementsByTagName('a');
                for (let a of links) {
                    if (a.href && !a.href.includes('googleusercontent')) {
                        a.href = proxyBase + encodeURIComponent(a.href);
                        a.target = "_self";
                    }
                }
            } catch (e) {
                // Security policy prevents deep-editing some domains, 
                // but the Google Proxy handles most of this server-side.
            }
        }, 2000);
    </script>
</body>
</html>
